!function(a){function b(){var b,d=a("#gp-auth-check"),f=a("#gp-auth-check-form"),g=e.find(".gp-auth-fallback-expired"),h=!1;f.length&&(a(window).on("beforeunload.gp-auth-check",function(a){a.originalEvent.returnValue=window.authcheckL10n.beforeunload}),b=a('<iframe id="gp-auth-check-frame" frameborder="0">').attr("title",g.text()),b.load(function(){var b,i;h=!0;try{i=a(this).contents().find("body"),b=i.height()}catch(j){return e.addClass("fallback"),d.css("max-height",""),f.remove(),void g.focus()}b?i&&i.hasClass("interim-login-success")?c():d.css("max-height",b+40+"px"):i&&i.length||(e.addClass("fallback"),d.css("max-height",""),f.remove(),g.focus())}).attr("src",f.data("src")),a("#gp-auth-check-form").append(b)),a("body").addClass("modal-open"),e.removeClass("hidden"),b?(b.focus(),setTimeout(function(){h||(e.addClass("fallback"),f.remove(),g.focus())},1e4)):g.focus()}function c(){a(window).off("beforeunload.gp-auth-check"),"undefined"==typeof adminpage||"post-php"!==adminpage&&"post-new-php"!==adminpage||"undefined"==typeof gp||!gp.heartbeat||gp.heartbeat.connectNow(),e.fadeOut(200,function(){e.addClass("hidden").css("display",""),a("#gp-auth-check-frame").remove(),a("body").removeClass("modal-open")})}function d(){var a=parseInt(window.authcheckL10n.interval,10)||180;f=(new Date).getTime()+1e3*a}var e,f;a(document).on("heartbeat-tick.gp-auth-check",function(a,f){"gp-auth-check"in f&&(d(),!f["gp-auth-check"]&&e.hasClass("hidden")?b():f["gp-auth-check"]&&!e.hasClass("hidden")&&c())}).on("heartbeat-send.gp-auth-check",function(a,b){(new Date).getTime()>f&&(b["gp-auth-check"]=!0)}).ready(function(){d(),e=a("#gp-auth-check-wrap"),e.find(".gp-auth-check-close").on("click",function(){c()})})}(jQuery);